<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Control de Dispositivos</title>
    <link rel="stylesheet" href="../static/styles.css">
</head>
<body>

    <h2>Mis Dispositivos</h2>

    <div id="device-list">
        {% for device in devices %}
        <div class="card" data-tag="{{ device.tag }}" data-name="{{ device.name }}">
            <span class="card-name">{{ device.name }}</span>
            <button class="options-btn" data-tag="{{ device.tag }}">⋮</button>
            {% if device.type == 'wol'%}
            <button class="wake-btn"
                    data-tag="{{ device.tag }}"
                    data-name="{{ device.name }}">
                Encender
            </button>
            {% endif %}
            {% if device.type == 'camera-usb' or device.type == 'camera'%}
            <button class="play-btn"
                    data-tag="{{ device.tag }}"
                    data-name="{{ device.name }}"
                    data-id="{{ device.ip }}">
                ▶️ VER
            </button>
            {% endif %}
            <button class="remove-device"
                    id="delete-device"
                    data-tag="{{ device.tag }}"
                    data-name="{{ device.name }}">
                ❌
            </button>
        </div>
        {% endfor %}
    </div>

    <div class="pop-up" id="pop-up-streaming" style="display: none;">
        <div class="popup-content-container">
            <h1 id="streaming-device"><!-- Se inserta desde main.js --></h1>
            <img id="video-player" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/103/2021/10/14162918/rickroll-e1634243370645.jpg" width="640" height="480">
            <div class="buttons-container" id="streaming-button-container">
                <button id="close-streaming-btn">Cerrar</button>
            </div>
        </div>
    </div>

    <div class="pop-up" id="pop-up-name-edit" style="display: none;">
        <div class="popup-content-container">
            <p>Inserte el nuevo nombre del dispositivo</p>
            <input type="text" placeholder="Nuevo nombre del dispositivo" id="edited-name" required>
            <div class="buttons-container" id="buttons-name-edit-container">
                <button id="save-name-btn">Guardar</button>
                <button id="cancel-name-btn">Cancelar</button>
            </div>
        </div>
    </div>

    <div class="pop-up" id="pop-up-confirmacion" style="display: none;">
        <div class="popup-content-container"> <!-- confirmation-popup-container -->
            <p id="mensaje-confirmacion"><!-- Se inserta desde main.js --></p>
            <div class="buttons-container" id="confirmation-buttons-container">
                <button id="boton-confirmar">Sí, eliminar</button>
                <button id="boton-cancelar">No, cancelar</button>
            </div>
        </div>
    </div>

    <a href="/add_device" class="add-device">➕ Agregar Dispositivo</a>
    {% if role == 'admin' %}
    <a href="/register" class="add-user">➕ Agregar Usuario</a>
    {% endif %}
    <button id="logout-button">Cerrar Sesión</button>

    <script type="module" src="../static/js/main.js"></script>
</body>
</html>